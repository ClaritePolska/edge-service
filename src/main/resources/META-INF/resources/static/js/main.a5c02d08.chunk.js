(this["webpackJsonpqiot-dashboard"]=this["webpackJsonpqiot-dashboard"]||[]).push([[0],{17:function(e,t,r){},18:function(e,t,r){},44:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),o=r(12),s=r.n(o),c=(r(17),r(2)),i=r(3),u=(r(18),r(5)),l=r.n(u),d=r(7),m=r(4),h=r(6),b=new(function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,[{key:"getSerialNumber",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://localhost:9443","/serial-number"));case 2:return t=e.sent,e.next=5,t.json();case 5:return r=e.sent,a=r.serialNumber,console.log(a),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"registerEdgeDevice",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://localhost:9443","/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(c.a)({},t))});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),j=function e(t,r){Object(m.a)(this,e),this.lat=t,this.lon=r},f=new(function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,[{key:"getCurrentPosition",value:function(){if("geolocation"in navigator){console.log("Available");var e={enableHighAccuracy:!0};return new Promise((function(t,r){return navigator.geolocation.getCurrentPosition((function(e){var r=new j(e.coords.latitude,e.coords.longitude);t(r)}),(function(){var e=new j(52.184139,21.02051);t(e)}),e)}))}return new Promise((function(e,t){e(new j(52.184139,21.02051))}))}},{key:"getLocationDetails",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var r,a,n,o,s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://us1.locationiq.com/v1/reverse.php?key=pk.10034caf64c0fc5c5c7c35a24632b4da&lat="+t.lat+"&lon="+t.lon+"&format=json");case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,n=a.address,o=n.country,s=n.city,c=n.town,e.abrupt("return",{country:o,city:null!==s&&void 0!==s?s:c});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),p=function(){function e(t,r,a,n,o){Object(m.a)(this,e),this.latitude=t,this.longitude=r,this.serial=a,this.keyStorePassword=n,this.name=o}return Object(h.a)(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}(),O=r(0),v=function(e){var t=Object(a.useState)(e),r=Object(i.a)(t,2),n=r[0],o=r[1],s=Object(a.useState)(!1),c=Object(i.a)(s,2),u=c[0],l=c[1];return{value:n,setValue:o,touched:u,setTouched:l,reset:function(){return o("")},bind:{value:n,onChange:function(e){o(e.target.value),l(!0)}}}},x=function(){var e=v(""),t=e.value,r=e.touched,n=e.setTouched,o=e.bind,s=e.reset,u=v(""),l=u.value,d=u.touched,m=u.setTouched,h=u.bind,j=u.reset,x=v(""),g=x.value,y=x.touched,w=x.setTouched,N=x.bind,S=x.reset,k=Object(a.useState)({nameNotMatch:!1,nameTooShort:!1,keyStorePasswordTooShort:!1,keyStorePasswordConfirmationTooShort:!1,keyStorePasswordConfirmationNotMatch:!1}),T=Object(i.a)(k,2),P=T[0],C=T[1],z=function(e){return e.length<5},F=function(e){return e.length<5},M=function(e){return e.length<5};Object(a.useEffect)((function(){var e,r,a;C({nameNotMatch:(a=t,!/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/g.test(a)),nameTooShort:z(t),keyStorePasswordTooShort:F(l),keyStorePasswordConfirmationTooShort:M(g),keyStorePasswordConfirmationNotMatch:(e=l,r=g,e!==r)})}),[t,l,g]);var q=Object(a.useState)(""),D=Object(i.a)(q,2),K=D[0],E=D[1],I=Object(a.useState)(),L=Object(i.a)(I,2),A=L[0],H=L[1],J=Object(a.useState)(!1),B=Object(i.a)(J,2),R=B[0],_=B[1],Q=Object(a.useState)(""),V=Object(i.a)(Q,2),$=V[0],G=V[1],U=Object(a.useState)(""),W=Object(i.a)(U,2),X=W[0],Y=W[1];return Object(a.useEffect)((function(){f.getCurrentPosition().then((function(e){return H({latitude:e.lat,longitude:e.lon}),f.getLocationDetails(e)})).then((function(e){E("".concat(e.country,", ").concat(e.city))}))}),[]),Object(O.jsx)("div",{className:"container-fluid col-8 offset-2",children:Object(O.jsxs)("div",{className:"row m-5 justify-content-center",children:[Object(O.jsx)("div",{className:"d-flex justify-content-center",children:Object(O.jsx)("a",{href:"https://events.redhat.com/profile/form/index.cfm?PKformID=0x3155530001",children:Object(O.jsx)("img",{className:"img-fluid d-block",src:"".concat("","/images/quarkus_iot_logo.png"),alt:"RedHat QIoT Hackfest 2021"})})}),Object(O.jsx)("div",{className:"d-flex justify-content-center mt-3",children:Object(O.jsx)("h1",{className:"heading text-uppercase",children:"Register device form"})}),Object(O.jsxs)("form",{className:"needs-validation mt-3",onSubmit:function(e){e.preventDefault();var r=A.latitude,a=A.longitude;b.registerEdgeDevice(new p(r,a,"000000001655e33a",l,t)).then((function(e){if(_(!0),200===e.status)return G("Success!"),Y("The edge device was registered successfully!"),void setTimeout((function(){_(!1),s(),j(),S(),n(!1),m(!1),w(!1)}),2e3);G("Error!"),Y("Internal server error."),setTimeout((function(){_(!1)}),2e3)}))},children:[R&&Object(O.jsxs)("div",{className:"alert ".concat("Success!"===$?"alert-success":"alert-danger"),role:"alert",children:[Object(O.jsx)("h4",{className:"alert-heading",children:$}),Object(O.jsx)("p",{children:X})]}),Object(O.jsxs)("div",{className:"form-group mt-3",children:[Object(O.jsx)("label",{htmlFor:"serial-number",children:"Serial number"}),Object(O.jsx)("input",{id:"serial-number",className:"form-control",type:"text","aria-describedby":"serial-number-help",placeholder:"Serial number",name:"serialNumber",value:"000000001655e33a",disabled:!0}),Object(O.jsx)("small",{id:"serial-number-help",className:"form-text text-muted",children:"The serial number of edge device."})]}),Object(O.jsxs)("div",{className:"form-group mt-3",children:[Object(O.jsx)("label",{htmlFor:"name",children:"Name"}),Object(O.jsx)("input",Object(c.a)(Object(c.a)({id:"name",className:"form-control ".concat((P.nameTooShort||P.nameNotMatch)&&r?"is-invalid":""),type:"text",placeholder:"Name",name:"name"},o),{},{required:!0,pattern:"[a-z0-9]([-a-z0-9]*[a-z0-9])?(.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*",title:"Name must contain lowercase characters, dash(-) and numbers only."}))]}),P.nameTooShort&&r&&Object(O.jsx)("p",{className:"text-danger",children:"Name must contain at least 5 characters."}),P.nameNotMatch&&r&&Object(O.jsx)("p",{className:"text-danger",children:"Name must contain lowercase characters, dash(-) and numbers only."}),Object(O.jsxs)("div",{className:"form-group mt-3",children:[Object(O.jsx)("label",{htmlFor:"address",children:"Address"}),Object(O.jsx)("input",{id:"address",className:"form-control",type:"text",name:"address",value:K,onChange:function(e){return E(e.target.value)},disabled:!0}),Object(O.jsx)("small",{id:"serial-number-help",className:"form-text text-muted",children:"Current location of edge device."})]}),Object(O.jsxs)("div",{className:"form-group mt-3",children:[Object(O.jsx)("label",{htmlFor:"keystore-password",children:"Keystore password"}),Object(O.jsx)("input",Object(c.a)(Object(c.a)({id:"keystore-password",className:"form-control ".concat(P.keyStorePasswordTooShort&&d?"is-invalid":""),type:"password",placeholder:"Keystore password",name:"keystorePassword"},h),{},{required:!0}))]}),P.keyStorePasswordTooShort&&d&&Object(O.jsx)("p",{className:"text-danger",children:"Keystore password must contain at least 5 characters."}),Object(O.jsxs)("div",{className:"form-group mt-3",children:[Object(O.jsx)("label",{htmlFor:"keystore-password-confirmation",children:"Keystore password confirmation"}),Object(O.jsx)("input",Object(c.a)(Object(c.a)({id:"keystore-password-confirmation",className:"form-control ".concat((P.keyStorePasswordConfirmationTooShort||P.keyStorePasswordConfirmationNotMatch)&&y?"is-invalid":""),type:"password",placeholder:"Keystore password confirmation",name:"keystorePasswordConfirmation"},N),{},{required:!0}))]}),P.keyStorePasswordConfirmationTooShort&&y&&Object(O.jsx)("p",{className:"text-danger",children:"Keystore password must contain at least 5 characters."}),P.keyStorePasswordConfirmationNotMatch&&y&&Object(O.jsx)("p",{className:"text-danger",children:"Confirmation password does not match keystore password."}),Object(O.jsx)("button",{disabled:Object.entries(P).some((function(e){return e[1]})),type:"submit",className:"btn btn-primary w-100 mt-4",children:"Submit"})]})]})})},g=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,45)).then((function(t){var r=t.getCLS,a=t.getFID,n=t.getFCP,o=t.getLCP,s=t.getTTFB;r(e),a(e),n(e),o(e),s(e)}))};r(21),r(22);s.a.render(Object(O.jsx)(n.a.StrictMode,{children:Object(O.jsx)(x,{})}),document.getElementById("root")),g()}},[[44,1,2]]]);
//# sourceMappingURL=main.a5c02d08.chunk.js.map