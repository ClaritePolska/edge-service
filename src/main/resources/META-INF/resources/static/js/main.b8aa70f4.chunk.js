(this["webpackJsonpqiot-dashboard"]=this["webpackJsonpqiot-dashboard"]||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(11),c=a.n(s),o=(a(16),a(2)),i=(a(17),a(4)),l=a.n(i),u=a(5),d=a(3),b=a(6),m=new(function(){function e(){Object(d.a)(this,e)}return Object(b.a)(e,[{key:"getSerialNumber",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://qiot-edge-edge-service.apps.ocp4.clarite.lab/","/serial-number"));case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,n=a.serialNumber,console.log(n),e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}()),j=function e(t,a){Object(d.a)(this,e),this.lat=t,this.lon=a},f=new(function(){function e(){Object(d.a)(this,e)}return Object(b.a)(e,[{key:"getCurrentPosition",value:function(){if("geolocation"in navigator){console.log("Available");var e={enableHighAccuracy:!0};return new Promise((function(t,a){return navigator.geolocation.getCurrentPosition((function(e){var a=new j(e.coords.latitude,e.coords.longitude);t(a)}),(function(){var e=new j(52.184139,21.02051);t(e)}),e)}))}return new Promise((function(e,t){e(new j(52.184139,21.02051))}))}},{key:"getLocationDetails",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,r,s,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://us1.locationiq.com/v1/reverse.php?key=pk.10034caf64c0fc5c5c7c35a24632b4da&lat="+t.lat+"&lon="+t.lon+"&format=json");case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,r=n.address,s=r.country,c=r.city,o=r.town,e.abrupt("return",{country:s,city:null!==c&&void 0!==c?c:o});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),h=a(0),p=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)(""),c=Object(o.a)(s,2),i=c[0],l=c[1],u=Object(n.useState)(""),d=Object(o.a)(u,2),b=d[0],j=d[1],p=Object(n.useState)(),O=Object(o.a)(p,2),g=O[0],v=O[1],x=Object(n.useState)(""),y=Object(o.a)(x,2),w=y[0],N=y[1],S=Object(n.useState)(""),k=Object(o.a)(S,2),C=k[0],P=k[1],z=Object(n.useState)(!0),F=Object(o.a)(z,2),q=F[0],T=F[1],D=Object(n.useState)(!0),K=Object(o.a)(D,2),L=K[0],A=K[1],E=Object(n.useState)(!0),J=Object(o.a)(E,2),B=J[0],I=J[1],H=Object(n.useState)(!1),M=Object(o.a)(H,2),G=M[0],Q=M[1];return Object(n.useEffect)((function(){m.getSerialNumber().then((function(e){return r(e)}))}),[]),Object(n.useEffect)((function(){f.getCurrentPosition().then((function(e){return v({latitude:e.lat,longitude:e.lon}),f.getLocationDetails(e)})).then((function(e){j("".concat(e.country,", ").concat(e.city))}))}),[]),Object(h.jsx)("div",{className:"container m-5",children:Object(h.jsxs)("form",{className:"needs-validation",onSubmit:function(e){e.preventDefault();var t=g.latitude,n=g.longitude;if(i&&i.match(/[a-z0-9]([-a-z0-9]*[a-z0-9])?(.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/))return w&&C&&w===C?void fetch("".concat("http://qiot-edge-edge-service.apps.ocp4.clarite.lab/","/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({latitude:t,longitude:n,serial:a,keystorePassword:w,name:i})}).then((function(e){Q(!0),setTimeout((function(){Q(!1),l(""),N(""),P("")}),2e3)})):(A(!1),void I(!1));T(!1)},children:[G&&Object(h.jsxs)("div",{className:"alert alert-success",role:"alert",children:[Object(h.jsx)("h4",{className:"alert-heading",children:"Success!"}),Object(h.jsx)("p",{children:"The edge device was registered successfully!"})]}),Object(h.jsxs)("div",{className:"form-group mt-2",children:[Object(h.jsx)("label",{htmlFor:"serial-number",children:"Serial number"}),Object(h.jsx)("input",{id:"serial-number",className:"form-control",type:"text","aria-describedby":"serial-number-help",placeholder:"Serial number",name:"serialNumber",value:a,onChange:function(e){return r(e.target.value)},disabled:!0}),Object(h.jsx)("small",{id:"serial-number-help",className:"form-text text-muted",children:"The serial number of edge device."})]}),Object(h.jsxs)("div",{className:"form-group mt-2",children:[Object(h.jsx)("label",{htmlFor:"name",children:"Name"}),Object(h.jsx)("input",{id:"name",className:"form-control ".concat(q?"":"is-invalid"),type:"text",placeholder:"Name",name:"name",onChange:function(e){return l(e.target.value)},value:i,required:!0,pattern:"[a-z0-9]([-a-z0-9]*[a-z0-9])?(.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*",title:"Name must contain lowercase characters, dash(-) and numbers only."})]}),!q&&Object(h.jsx)("p",{className:"text-danger",children:"Please enter a name"}),Object(h.jsxs)("div",{className:"form-group mt-2",children:[Object(h.jsx)("label",{htmlFor:"address",children:"Address"}),Object(h.jsx)("input",{id:"address",className:"form-control",type:"text",name:"address",value:b,onChange:function(e){return j(e.target.value)},disabled:!0}),Object(h.jsx)("small",{id:"serial-number-help",className:"form-text text-muted",children:"Current location of edge device."})]}),Object(h.jsxs)("div",{className:"form-group mt-2",children:[Object(h.jsx)("label",{htmlFor:"keystore-password",children:"Keystore password"}),Object(h.jsx)("input",{id:"keystore-password",className:"form-control ".concat(L?"":"is-invalid"),type:"password",placeholder:"Keystore password",name:"keystorePassword",onChange:function(e){return N(e.target.value)},value:w,required:!0})]}),!L&&Object(h.jsx)("p",{className:"text-danger",children:"Please enter a valid keystore password"}),Object(h.jsxs)("div",{className:"form-group mt-2",children:[Object(h.jsx)("label",{htmlFor:"keystore-password-confirmation",children:"Keystore password confirmation"}),Object(h.jsx)("input",{id:"keystore-password-confirmation",className:"form-control ".concat(B?"":"is-invalid"),type:"password",placeholder:"Keystore password confirmation",name:"keystorePasswordConfirmation",onChange:function(e){return P(e.target.value)},value:C,required:!0})]}),!B&&Object(h.jsx)("p",{className:"text-danger",children:"Please enter a valid keystore password confirmation"}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary w-100 mt-4",children:"Submit"})]})})},O=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,44)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))};a(20),a(21);c.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(p,{})}),document.getElementById("root")),O()}},[[43,1,2]]]);
//# sourceMappingURL=main.b8aa70f4.chunk.js.map